#!/usr/bin/env bash

export PANE_FILE="/tmp/peco-glimpse-$$.pane"

trap "kill_pane_from_pane_file '${PANE_FILE}'" EXIT

SELECTED="$(rg --vimgrep "${@}" | peco)"
if [[ $? -eq "0" && -n "${SELECTED}" ]] ; then
    on_exit
    exec ${EDITOR} $(echo "${SELECTED}" | awk -F ':' '{print $1}' | sort | uniq)
fi
